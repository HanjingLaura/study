---
title: "R"
date: 2025-01-14
draft: false
---

# R
- 基础语法规则
    - 赋值
        - 标准赋值用`<-`,也可也用`=`,但是`=`更多用于函数参数传递
        - 数字
            - ```x <- 10```
        - 字符串
            - ```name <- "xxx"```
        - 布尔值
            - ```is_valid <- TRUE```
    - 大小写敏感
    - 索引从1开始，数组（向量）的下标从1开始
    - 注释使用`#`
- 数据类型
    - Numeric (数值型)：浮点数
    - Integer (整型)：整数
    - Character (字符型)：字符串，使用单引号或双引号
    - Logical (逻辑型)：`TRUE` 和 `FALSE`（必须全大写，缩写为 `T` / `F`）
    - Complex (复数)
- 数据结构
    - Vector (向量)
    - 同一类型的元素序列
        - 用c()函数创建
            - ```scores <- c(1,2,3)```
            - ```names <- c("a","b","c")```
    - Matrix (矩阵)
        - 二维数组，所有元素必须相同
        - 用martrix创建
            - ```m <- matrix(1:6, nrow = 2, ncol = 3)```
    - List (列表)
        - 可以包含不同类型，不同长度的元素
        - 用list创建
            - ```my_list <- list(name = "xxx", version = 1.0, data = c(1,2,3))```
        - 访问
            - ```my_list$name```
            - ```my_list[[1]]```
    - Data Frame (数据框)
        - 表格结构，每一列是一个向量，每列的类型必须相同，不同列可以不同
        - 用data.frame创建
            - ```df <- data.frame(ID = 1:3, Score = c(90, 80, 70))```
        - 访问
            - 访问行
                - ```df[1, ]```(访问第一行)
            - 访问列
                - ```df[ ,1]```(访问第一列)
                - ```df$Score```
    - Factor (因子)
        - 用于处理分类数据
- 运算符
    - 算术运算
        - `+`, `-`, `*`, `/`, `^` (幂), `%%` (取模), `%/%` (整除)
    - 比较运算
        - `==`, `!=`, `>`, `<`, `>=`, `<=`
    - 逻辑运算
        - `&` (与), `|` (或), `!` (非)
- 控制流
    - 在 R 中，能用向量化运算就不要写循环，循环在 R 里效率相对较低
    - 条件判断
        ```
        if (x > 0) {
        # 代码
        } else if (x == 0) {
        # 代码
        } else {
        # 代码
        }
        ```
    - 循环
        - for循环
            ```
            for (i in 1:10) {
            print(i)
            }
            ```
        - while循环
            ```
            while (condition) {
            # 代码
            }
            ```
- 函数
    - 定义
        ```
        my_func <- function(arg1, arg2 = 10) {
        result <- arg1 + arg2
        return(result)  # 或者直接写 result，R 会返 回最后一行表达式的值
        }
        ```    
    - 调用
        ```
        my_func(5, 20)
        my_func(arg1 = 5) # 使用默认参数
        ```  
- 数据的选取
    - 按索引
        - v[1]:第一个
        - v[-1]：除了第一个以外的所有
    - 按布尔值
        - v[v > 5]：筛选出大于 5 的元素
    - 二维选取
        - df[行索引, 列索引]
        - df[1, 2]：第 1 行第 2 列
        - df[1, ]：第 1 整行
        - df[, 2]：第 2 整列
    - 按名称
        - df$Score
        - df[["Score"]]
- 管道操作
    - 传统写法：`plot(mean(df$Score))`
    - 管道写法 (`%>%` 或新版的 `|>`):
        - `df$Score %>% mean() %>% plot()`
        - 语义：把左边的结果传给右边函数的第一个参数
- 包管理
    - 安装
        - `install.packages("包名")`
    - 加载
        - `library(包名)`