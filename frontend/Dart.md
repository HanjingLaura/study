---
title: "Dart"
date: 2026-01-17
draft: false
---

# Dart
## 基础语法
- 变量声明
    - var：自动推断类型，变量
        - 有编译检查，仅限推断的属性和方法
    - final：运行时常量，赋值一次后不可变
        - 在Flutter中定义Widget属性最常用
    - const：编译时常量
        - 用于提升性能，不允许表达式中有变量存在，必须为常量或固定值 
    - late：延迟初始化
    - 基础类型
        - 数字
            - int
            - double
            - num：整型小数均可
            - int，double不能直接赋值，num不能给double赋值，double可以给num赋值 
        - String
            - String 属性名 = '文本内容$变量名'
            - String 属性名 = '文本内容${变量名}'
        - bool
        - List
            - List 属性名 = ['a','b']
            - 尾部添加：add(内容)
            - 尾部添加列表：addAll(列表)
            - 删除满足内容的第一个：remove(内容)
            - 删除最后一个：removeLast()
            - 和三处索引范围内数据：removeRange(start,end)
            - 循环：forEach((item){})
            - 是否都满足条件：every((item){return 布尔值})
            - 筛选出满足条件的数据：where((ietm){return 布尔值})
            - 列表的长度：length
            - 最后一个元素：last
            - 第一个元素：first
            - 是否为空：isEmpty
        - Map
            - Map 属性名 = {key:value}
            - 字典[key] 可以取值赋值
            - 循环：forEach
            - 添加一个字典：addAll
            - 是否包含某个key：containsKey
            - 删除某个key：remove
            - 清空：clear
        - dynamic
            - 用于声明动态类型
            - 允许变量在运行是自由改变类型，同时绕过编译时的静态检查
            - dynamic 属性名 = 值
            - 无编译检查，方法和属性直接调用
- 空安全
    - Dart是强空安全的语言，防止了常见的空指针异常
        - 通过编译静态检查将运行时空指针提前暴露
        - 强制要求处理控制，防止程序崩溃
    - 语法
        - String?：表示可以为null
        - late：声明一个稍后才会初始化的非空常量（常用于initState）
        - ??：如果左边为空，则返回右侧值
        - ?.：条件访问，如果对象不为空才调用方法
        - !.：非空断言，开发者保证变量非空，否则运行时崩溃
    - eg
        ```
        String? name;//?表示可以为null
        String title = name??"默认标题"//??如果左边为空，则使用右侧值
        print(name!.length);//!强行断言不为空（慎用）
        ``` 
- 运算符
    - 算数运算符
        - +：加
        - -：减
        - *：乘
        - /：除
        - ~/：整除
        - %：取余
    - 赋值运算符
        - =：赋值操作
        - +=：加等
        - -=：减等
        - *=：乘等；
        - /=：除等
    - 比较运算符
        - ==：两个值相等
        - !=：两个值不等
        - >
        - >=
        - <
        - <=
    - 逻辑运算符
        - &&：与
        - ||：或
        - ！：非
- 流程控制
    - if
        - if
        - else if
        - else
    - 三元运算符
        - 表达式（布尔值）？结果1：结果2；
    - switch/case
        - switch（变量）{
            case 值1：
                逻辑1；
                break；
            case 值2：
                逻辑2；
                break；
            default；
        }
    - 循环
        - while
            - while（条件）{
                逻辑；
            }
            - break
            - continue
        - for
            - for(int i=0;1<10;i++){
                逻辑；
            }
- 函数
    - 函数定义
        - 返回类型 
        - 函数名
        - 参数
        - 函数体
    - 返回值
        - 分类
            - 有返回值
                - 具体类型 函数名称(){}
            - 无返回值
                - void 函数名称(){}
            - 返回值类型可省略，Dart会自动判断类型为Dynamic
    - 参数
        - 分类
            - 必传参数
                - 不能为空
            - 可选位置参数
                - 在必传参数后，用[]包裹
                - 函数名(String a,[String?b,...]),
                    - 传递时含顺序传递
                - 适用于参数少且顺序固定
            - 可选命名参数
                - 在必传参数后面，用{}包裹
                - 函数名(String a,{String b,...})
                    - 传递时按照 参数名：值 的方式进行传递，无需关注顺序
                - 适用于参数多且需明确含义
    - 匿名函数
        - 可以申明一个没有名称的函数赋值给变量，进行调用
        - Function 变量名 = (){};
    - 箭头函数
        - 函数体只有一行代码
        - 函数名()=>代码逻辑
        - 可以省略return关键字
- 类
    - class
        - 面向对象编程的核心，包含属性和方法来定义对象的行为和状态
        - 定义Person类：class Person{属性 方法}
            - 实例化对象：Person 变量=Person();
            - 属性和方法：变量.属性/方法()
    - 构造函数
        - 默认构造函数
            - 实例化对象时，使用构造函数直接给对象中的属性赋值
            - 构造函数分类
                - 默认构造函数
                - 命名构造函数
                - 构造函数的语法糖
            - 语法：
                ```
                class 类名{
                    类名(可选命名参数){
                    }
                } 
                ```
            - 实例化语法：
                - Person p=new Person(属性：值)
        - 命名构造函数
            - 构造函数可采用命名的方式，返回一个实例化对象
            - 语法：
                ```
                class 类名{
                    类名.构造函数名(可选命名参数){
                    }
                } 
                ``` 
            - 实例化语法：
                - Person p=Person.构造函数名(属性：值)
        - 构造函数语法糖
            - 同名构造函数和命名构造函数都支持简写
            - 语法：
                ```
                class 类名{
                    类名({this.属性1，this.属性2})；
                    类名.命名函数({this.属性1，this.属性2})；
                } 
                ``` 
    - 公有属性和私有属性
        - 公有属性
            - 提供自身或其他外部文件和类使用的属性和方法
        - 私有属性
            - 仅供自身使用的属性和方法，其他外部文件和类无法访问
        - 私有属性以下划线开头
            - 如_name，其余均为公有属性 
    - 继承
        - 拥有父类的属性和方法
        - Dart属于单继承，一个类只能拥有一个直接父类，子类拥有父类所有的属性和方法
        - 语法
            - class 类名 extends 父类
        - 重写
            - 子类可通过@override注解重写父类方法，扩展其行为
        - 子类不会继承父类的构造函数，子类必须通过super关键字调用父类的构造函数确保父类正确初始化
            - super语法：子类构造函数(可选名命名参数):super({参数})
    - 多态
        - Dart中的类是指同一操作作用于不同的对象，可以战胜不同的执行效果
        - 实现方式
            - 继承和方法重写
                - 定义不同子类继承同一个父类
            - 抽象类和接口 
                - 使用abstract关键字声明一个抽象类(没有实现体)
                - 使用implements关键字继承并实现抽象类
    - 类的混入
        - 在不使用传统继承的情况下，想类中添加新的功能
        - 使用mixin关键字定义一个对象
        - 使用with关键字将定义的对象混入到当前对象
        - 一个类支持with多个mixin，调用优先级遵循后来居上原则，即后混入的会覆盖先混入的同名方法
    - Dart中泛型
        - Dart中允许使用类型参数，限定类型的同时又让类型更加灵活，让代码更加健壮和维护性更强
        - eg：List类型中只想存储String类型，函数返回值希望和参数一个类型
        - 分类 
            - 泛型集合
            - 泛型方法
            - 泛型类
        - 语法
            - List<String>
            - Map<String,int>
            - T getValue<T>(T value){
                return value;
            }
    - 异步编程
        - Dart是单线程语言，即同时只能做一件事，遇到耗时任务会造成程序堵塞，此时需要异步编程
        - 采用单线程+事件循环的机制完成耗时任务的处理
        - 事件循环
            - 执行同步代码->执行微任务队列->执行事件队列->结束
            - 微任务队列
                - Future.microtask()
            - 事件队列
                - Future,Future.delayed(),I/O操作（文件，网络）
        - Future
            - 代表一个异步操作的最终结果
            - 状态 
                - Uncompleted：等待
                - Completed with a value：成功
                - Completed with a error：失败
            - 创建：Future((){})
            - 执行成功：不抛出异常-成功状态-then((){})
            - 执行失败：throw Exception()-失败状态-catchError((){})
        - 链式调用
            - 可通过链式的方式连续得到异步的结果
            - 语法
                - Future().then()拿到执行成功的结果
                - Future().Error()拿到执行失败的结果
                - 在上一个the返回对象会在下一个then中接收 
        - 异步编程
            - 除了then/catchError的方式，还可以通过async/await来实现异步编程
          - await总是等到后面的Future执行成功，才执行下方逻辑，async必须配套await出现
          - 语法
                ```
                函数名()asnyc{
                    try{
                        await Future();
                        //Future执行成功才执行的逻辑
                    }
                    catch(error){
                        //执行失败的逻辑
                    }
                } 